# 1.2. Угрозы и уязвимости реализованной биометрической системы

Анализ кода разработанной системы выявляет конкретные уязвимости, характерные для биометрических систем без дополнительных модулей защиты. Основные угрозы связаны с архитектурными решениями в классах `FaceRecognitionEngine`, `CameraManager` и `Database`.

## Презентационные атаки в текущей реализации

Метод `process_frame` в `face_recognition_engine.py` принимает любое изображение с обнаруженным лицом без проверки его подлинности. Функция `face_recognition.face_locations()` одинаково обрабатывает живые лица и фотографии, что позволяет злоумышленнику использовать распечатанные снимки или изображения с экрана монитора.

В классе `CameraManager` метод `_capture_loop` получает кадры напрямую с камеры без анализа признаков живого лица. Система не проверяет моргание, движение головы или другие динамические характеристики, которые могли бы выявить использование статических изображений.

Диалог добавления пользователей `AddUserDialog` в методе `process_image_file` принимает загружаемые изображения без ограничений на источник или метаданные файла. Злоумышленник может зарегистрироваться в системе, используя фотографию другого человека, скачанную из социальных сетей.

Виджет распознавания лиц `FaceRecognitionWidget` отображает результат идентификации без индикации уровня достоверности проверки подлинности. Пользователь не получает информации о том, что система не выполняла проверку живого лица.

## Уязвимости хранения биометрических данных

Класс `Database` в методе `add_user` сохраняет биометрические шаблоны в незашифрованном JSON формате в SQLite базе. Поле `face_encoding` содержит 128-элементный массив в открытом виде, что позволяет извлечь биометрические данные при получении доступа к файлу базы.

Метод `get_all_users` загружает все биометрические шаблоны в память через `json.loads(user_dict['face_encoding'])` без проверки целостности данных. Модификация файла базы данных может привести к компрометации биометрических характеристик пользователей.

Кэширование в `FaceRecognitionEngine` хранит биометрические шаблоны в списках `known_encodings` и `known_users` в оперативной памяти без защиты. Дамп памяти процесса может раскрыть все биометрические данные зарегистрированных пользователей.

Файл кэша `ENCODINGS_FILE` создается методом `_save_to_cache()` с использованием модуля `pickle` без шифрования. Это создает дополнительную копию биометрических данных в файловой системе в незащищенном виде.

## Недостатки системы аудита

Журналирование в методе `add_recognition_log` класса `Database` фиксирует только успешные распознавания без детального контекста события. Система не регистрирует множественные неудачные попытки, которые могут указывать на атаки перебора.

Таблица `recognition_logs` не содержит информации об источнике запроса, IP-адресе или идентификаторе сессии. Отсутствие контекстных данных затрудняет расследование инцидентов безопасности и выявление аномальной активности.

Метод `log_authentication_attempt` в аудиторских функциях не реализован в текущей версии системы. Попытки входа администраторов регистрируются только через обновление поля `last_login` без фиксации неудачных попыток.

Системное журналирование через модуль `logging` записывает события в текстовые файлы без защиты от модификации. Злоумышленник с доступом к файловой системе может изменить или удалить журналы для сокрытия следов атаки.

## Архитектурные уязвимости

Singleton реализация `CameraManager` создает единую точку отказа в системе. Компрометация менеджера камеры может привести к полной потере контроля над видеопотоком и возможности подмены данных.

Отсутствие разделения привилегий в архитектуре позволяет всем администраторам выполнять любые операции. Класс `Database` не проверяет права доступа при выполнении критических операций, таких как добавление или удаление пользователей.

Обработка ошибок в методах распознавания часто использует общие блоки `except Exception`, что может скрывать специфические атаки или попытки эксплуатации уязвимостей. Метод `process_frame_for_recognition` в `FaceRecognitionWidget` подавляет все исключения, потенциально маскируя попытки внедрения кода.

Конфигурационные данные в файле `config.py` содержат критические параметры безопасности, такие как `DEFAULT_ADMIN_PASSWORD`, в открытом виде. Компрометация исходного кода раскрывает учетные данные по умолчанию для доступа к системе.